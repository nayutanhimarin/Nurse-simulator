<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICUリーダー采配シミュレーター</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="app-container">

        <!-- ▼▼▼ サイドパネルを左側に移動 ▼▼▼ -->
        <div class="side-panel">
            <div class="heatmap-controls-container">
                <h4>&#x1F525; 業務量ヒートマップ</h4>
                <div class="time-selector">
                    <label for="heatmap-time">表示時刻:</label>
                    <input type="time" id="heatmap-time" name="heatmap-time" value="08:00" step="300">
                    <button id="btn-update-heatmap">表示</button>
                </div>
                <div class="heatmap-legend">
                    <div class="legend-item" style="background-color: #e6f5e6;">1: 応援可</div>
                    <div class="legend-item" style="background-color: #ffffcc;">2</div>
                    <div class="legend-item" style="background-color: #ffe6b3;">3: 標準</div>
                    <div class="legend-item" style="background-color: #ffcc99;">4</div>
                    <div class="legend-item" style="background-color: #ffb380;">5: 要応援</div>
                </div>
            </div>

            <div class="care-list-container">
                <h3>ケアリスト</h3>
                <div class="care-list-tabs"></div>
                <div class="care-list-body"></div>
            </div>
        </div>
        <!-- ▲▲▲ ここまでサイドパネル ▲▲▲ -->

        <!-- ▼▼▼ 左側のメインパネル ▼▼▼ -->
        <div class="main-panel">
            
            <div class="header-container">
                <h1>&#x1F469;&#x200D;&#x2695;&#xFE0F; ICUリーダー采配シミュレーター</h1>
            </div>

            <!-- ▼▼▼ シナリオ管理コントロールをここに移動 ▼▼▼ -->
            <div class="control-group" id="scenario-control-group">
                <label for="scenario-select">シナリオ:</label>
                <select id="scenario-select"></select>
                <input type="text" id="scenario-name" placeholder="新しいシナリオ名">
                <button id="btn-save-scenario">保存</button>
                <button id="btn-delete-scenario" class="danger-btn">削除</button>
            </div>
            <!-- ▲▲▲ シナリオ管理コントロールをここに移動 ▲▲▲ -->

            <div class="ward-display-area">
                <div class="ward-row" id="south-ward-row">
                    <button id="btn-south" class="ward-tab tab-button">南病棟</button>
                    <div class="bed-display-container" id="south-beds-display"></div>
                </div>
                <div class="ward-row" id="north-ward-row" class="active">
                    <button id="btn-north" class="ward-tab tab-button active">北病棟</button>
                    <div class="bed-display-container" id="north-beds-display"></div>
                </div>
            </div>

            <div class="controls-container">
                <div class="control-group">
                    <div class="mode-tabs">
                        <button id="btn-nurse-board" class="tab-button active">看護師ボード</button>
                        <button id="btn-bed-board" class="tab-button">ベッドボード</button>
                    </div>
                    <div class="nurse-count-settings">
                        <div>
                            <label for="count-south">南病棟:</label>
                            <input type="number" id="count-south" value="7" min="1">
                        </div>
                        <div>
                            <label for="count-north">北病棟:</label>
                            <input type="number" id="count-north" value="6" min="1">
                        </div>
                    </div>
                </div>
                <div class="control-group">
                    <div class="mode-tabs">
                        <button id="btn-am" class="tab-button active">午前</button>
                        <button id="btn-pm" class="tab-button">午後</button>
                    </div>
                    <div id="trash-can" class="trash-can-area">
                        &#x1F5D1;
                    </div>
                </div>
            </div>

            <div class="schedule-board-container">
                <div class="left-column-group">
                    <div class="names-area">
                        <div class="names-header-spacer"></div>
                    </div>
                    <div class="patient-summary-area">
                        <div class="patient-summary-header">患者概要</div>
                    </div>
                </div>
                <div class="timeline-area">
                    <div class="timeline-container">
                        <div class="timeline-header">
                            <div class="time-row hour-row"></div>
                            <div class="time-row minute-row"></div>
                        </div>
                        <div class="timeline-body"></div>
                    </div>
                </div>
            </div>

            <!-- ▼▼▼ ケアセットプランナーをメインパネル下部に移動 ▼▼▼ -->
            <div id="care-set-container">
                <div class="care-set-header">
                    <h4>&#x1F4DC; ケアセットプランナー</h4>
                    <button id="btn-toggle-careset-planner">表示/非表示</button> <!-- ★★★ 表示/非表示ボタンを追加 ★★★ -->
                    <div class="care-set-selectors">
                        <select id="care-set-dept-select"></select>
                        <select id="care-set-summary-select"></select>
                        <select id="care-set-supplement-select"></select>
                    </div>
                    <div class="care-set-actions">
                        <button id="btn-new-careset">新規</button>
                        <button id="btn-save-careset">登録</button>
                        <button id="btn-delete-careset" class="danger-btn">削除</button>
                        <div id="care-set-trash-can" class="trash-can-area">&#x1F5D1;</div>

                        <div id="new-careset-popup" class="popup-hidden">
                            <form id="new-careset-form">
                                <h4>ケアセット新規作成</h4>
                                <div class="form-group"><label for="new-careset-dept">科</label><select id="new-careset-dept" required></select></div>
                                <div class="form-group"><label for="new-careset-summary">患者概要</label><select id="new-careset-summary" required></select><input type="text" id="new-careset-summary-text" placeholder="概要を自由記述" style="display: none; margin-top: 5px;"></div>
                                <div class="form-group"><label for="new-careset-supplement">補足 (任意)</label><input type="text" id="new-careset-supplement" placeholder="例: 抜管後、術後1日目 など"></div>
                                <div class="modal-actions"><button type="submit">作成</button></div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="care-set-body">
                    <div id="care-set-am" class="care-set-group" draggable="true">
                        <h4 id="care-set-am-header">午前のケアセット</h4>
                        <div id="care-set-am-list" class="care-set-timeline-list"></div>
                    </div>
                    <div id="care-set-pm" class="care-set-group" draggable="true">
                        <h4 id="care-set-pm-header">午後のケアセット</h4>
                        <div id="care-set-pm-list" class="care-set-timeline-list"></div>
                    </div>
                </div>
            </div>
            <!-- ▲▲▲ ここまでケアセットプランナー ▲▲▲ -->
        </div>
        <!-- ▲▲▲ ここまでメインパネル ▲▲▲ -->

    </div>

    <!-- ▼▼▼ モーダルウィンドウのHTMLを追加 ▼▼▼ -->
    <div id="modal-overlay" class="modal-hidden">
        <div id="task-modal">
            <h2>タスク詳細設定</h2>
            <form id="task-form">
                <div class="form-group">
                    <label>タスク名:</label>
                    <p id="modal-task-name" class="modal-task-name-display"></p>
                </div>
                <div class="form-group">
                    <label for="modal-start-time">開始時刻:</label>
                    <input type="time" id="modal-start-time" step="300" required>
                </div>
                <div class="form-group">
                    <label>担当看護師:</label>
                    <div id="modal-nurse-list" class="modal-checkbox-list"></div>
                </div>
                <div class="form-group">
                    <label for="modal-bed-select">担当ベッド:</label>
                    <select id="modal-bed-select" required></select>
                </div>
                <div class="modal-actions">
                    <button type="button" id="modal-delete-btn" class="danger-btn">削除</button>
                    <button type="submit" id="modal-confirm-btn">決定</button>
                    <button type="button" id="modal-cancel-btn">キャンセル</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ▼▼▼ 患者情報モーダル ▼▼▼ -->
    <div id="patient-modal-overlay" class="modal-hidden">
        <div id="patient-modal">
            <h2 id="patient-modal-title">ベッド情報編集</h2>
            <form id="patient-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="patient-dept">科</label>
                        <select id="patient-dept">
                            <option>呼外</option>
                            <option>心外</option>
                            <option>脳外</option>
                            <option>肝外</option>
                            <option>消外</option>
                            <option>泌尿器</option>
                            <option>産婦</option>
                            <option>脊外</option>
                            <option>救急</option>
                            <option>循内</option>
                            <option>消内</option>
                            <option>他内科</option>
                            <option>皮膚科/形成外科</option>
                            <option>小児/小児外科</option>
                            <option>小児心外</option>
                            <option>その他</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="patient-severity">重症度</label>
                        <select id="patient-severity">
                            <option value="1">1 (軽症)</option>
                            <option value="2">2</option>
                            <option value="3">3 (標準)</option>
                            <option value="4">4</option>
                            <option value="5">5 (重症)</option>
                        </select>
                    </div>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="patient-is-empty">
                        <label for="patient-is-empty">空床</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="patient-summary-select">患者概要</label>
                    <select id="patient-summary-select"></select>
                    <input type="text" id="patient-summary-text" placeholder="概要を自由記述">
                </div>
                <div class="form-row device-checks">
                    <div class="form-group checkbox-group"><input type="checkbox" id="patient-vent"><label for="patient-vent">人工呼吸</label></div>
                    <div class="form-group checkbox-group"><input type="checkbox" id="patient-purification"><label for="patient-purification">血液浄化</label></div>
                    <div class="form-group checkbox-group"><input type="checkbox" id="patient-assist"><label for="patient-assist">補助循環</label></div>
                    <div class="form-group checkbox-group"><input type="checkbox" id="patient-delirium"><label for="patient-delirium">せん妄</label></div>
                </div>
                <div class="form-group">
                    <label for="patient-mobility">離床具合</label>
                    <select id="patient-mobility"><option>床上</option><option>端坐位</option><option>立位</option><option>歩行</option></select>
                </div>
                <div class="form-row plan-group">
                    <div class="form-group checkbox-group"><input type="checkbox" id="patient-discharge-plan"><label for="patient-discharge-plan">転棟予定</label><input type="time" id="patient-discharge-time" class="plan-time-hidden"></div>
                    <div class="form-group checkbox-group"><input type="checkbox" id="patient-admission-plan"><label for="patient-admission-plan">入室予定</label><input type="time" id="patient-admission-time" class="plan-time-hidden"></div>
                </div>
                <div class="modal-actions"><button type="submit">決定</button><button type="button" id="patient-modal-cancel">キャンセル</button></div>
            </form>
        </div>
    </div>

    <!-- ▼▼▼ 看護師設定モーダル ▼▼▼ -->
    <div id="nurse-modal-overlay" class="modal-hidden">
        <div id="nurse-modal">
            <h2 id="nurse-modal-title">看護師設定</h2>
            <form id="nurse-form">
                <div class="form-group">
                    <label for="nurse-level">看護師レベル</label>
                    <select id="nurse-level">
                        <option>新人</option>
                        <option>フリージア</option>
                        <option>非リーダー</option>
                        <option>リーダー</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>基本担当ベッド (最大3つ)</label>
                    <div id="nurse-bed-list" class="modal-checkbox-list"></div>
                </div>
                <div class="modal-actions"><button type="submit">決定</button><button type="button" id="nurse-modal-cancel">キャンセル</button></div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>