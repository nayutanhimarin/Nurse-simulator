/* 基本設定 */
body {
    font-family: sans-serif;
    background-color: #f4f4f4;
    padding: 20px;
    margin: 0; /* ★bodyの余白をリセット */
}

/* 5分 (1コマ) の幅を定義します */
:root {
    --col-width-5min: 8px; 
    --col-width-10min: calc(var(--col-width-5min) * 2);
    --row-height: 24px; 

    /* ★ヘッダーの高さを変数で一元管理 */
    --header-hour-height: 27px; /* padding(5*2) + font-size(16) + border(1) */
    --header-minute-height: 21.5px; /* font-size(10) + α */
    --header-total-height: calc(var(--header-hour-height) + var(--header-minute-height));

    --patient-summary-width: 75px; /* ★患者概要列の幅を定義 */
    --names-area-width: 100px;

    /* ▼▼▼ カテゴリごとの色を定義 ▼▼▼ */
    --color-care: #aee1e1;
    --color-work: #f6d186;
    --color-treatment: #ffb3b3;
    --color-other: #d9d9d9;
    --color-break: #c1e1c1;
    /* ▲▲▲ カテゴリごとの色を定義 ▲▲▲ */
}

/* ▼▼▼ 全体レイアウトを再構築 ▼▼▼ */
.app-container {
    display: flex;
    gap: 20px;
}
.main-panel {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 15px;
}
.side-panel {
    width: 300px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    gap: 15px;
}
/* ▲▲▲ 全体レイアウトを再構築 ▲▲▲ */

/* ★全体レイアウト (左:名前 / 右:タイムライン) */
.schedule-board-container {
    display: flex;
    border: 1px solid #ccc;
    background-color: #fff;
}
.left-column-group {
    display: flex;
    flex-shrink: 0; /* 縮まないように */
}
.names-area {
    width: var(--names-area-width);
    flex-shrink: 0; /* 縮まないように */
    border-right: 1px solid #ccc;
    box-sizing: border-box;
}
/* ★患者概要エリア */
.patient-summary-area {
    width: var(--patient-summary-width);
    flex-shrink: 0;
    border-right: 1px solid #ccc;
}
.timeline-area {
    overflow-x: auto; /* ★横スクロールをここに設定 */
    flex-grow: 1;
}

/* タイムライン全体 (★横スクロールをtimeline-areaに移管) */
.timeline-container {
}

/* 時間ヘッダー (8時... と 0 10 20...) */
.timeline-header {
    border-bottom: 2px solid #aaa;
    background-color: #f9f9f9;
    
    /* ★スクロール時にヘッダーを固定する */
    position: sticky;
    top: 0;
    z-index: 20; /* 他の要素より手前に */
}

/* ★左側：名前エリアのヘッダー高さ合わせ用 */
.names-header-spacer {
    height: var(--header-total-height);
    border-bottom: 2px solid #aaa;
    background-color: #f9f9f9;
}
/* ★患者概要エリアのヘッダー */
.patient-summary-header {
    height: var(--header-total-height);
    border-bottom: 2px solid #aaa;
    background-color: #f9f9f9;
    border-left: 1px solid #ccc;
    display: flex; /* 文字を中央揃えにするため */
    align-items: center;
    justify-content: center;
}

/* ★左側：看護師名 */
.nurse-name-block {
    /* 1人分(3行)の高さに */
    height: calc(var(--row-height) * 3);
    padding: 5px;
    font-weight: bold;
    border-bottom: 1px solid #ccc;
    border-right: 1px solid #ccc;
    box-sizing: border-box;
    display: flex;
    align-items: center;
    cursor: pointer;
}
/* ▼▼▼ ここから追加 ▼▼▼ */
/* ベッドボード用の名前ブロック（1行の高さ） */
.bed-name-block {
    height: var(--row-height);
    padding: 5px;
    font-weight: bold;
    border-bottom: 1px solid #ccc;
    border-right: 1px solid #ccc;
    box-sizing: border-box;
    display: flex;
    align-items: center;
    justify-content: center; /* 中央揃え */
    cursor: pointer;
}
/* ★患者概要ブロック */
.patient-summary-block {
    height: var(--row-height);
    padding: 5px;
    font-size: 12px;
    border-bottom: 1px solid #ccc;
    border-left: 1px solid #ccc;
    box-sizing: border-box;
    white-space: nowrap;
    overflow: hidden;
}
/* ▲▲▲ ここまで追加 ▲▲▲ */


.time-row {
    display: flex; 
    box-sizing: border-box;
}
.hour-row {
    border-bottom: 1px solid #ccc;
    height: var(--header-hour-height);
}
.hour-block {
    width: calc(var(--col-width-10min) * 6); 
    text-align: center;
    font-weight: bold;
    font-size: 16px;
    border-right: 1px solid #ccc;
    box-sizing: border-box; 
    line-height: var(--header-hour-height);
}
.minute-row { } /* 警告対策（削除してもOK） */
.minute-block {
    width: var(--col-width-10min); 
    text-align: center; 
    font-size: 10px;
    color: #555;
    border-right: 1px dotted #ddd; 
    box-sizing: border-box;
    line-height: var(--header-minute-height);
}
.minute-block.half-hour {
    border-right: 1px solid #bbb;
}


/* ★★★ タイムライン本体 ★★★ */
.timeline-body {
    /* JSで中身が追加されます */
}

/* ★看護師1人分 (3行) のグループ */
.nurse-row-group {
    height: calc(var(--row-height) * 3); /* ★3行分の高さ */
    box-sizing: border-box; /* ★罫線によるズレを防止 */
    border-bottom: 1px solid #ccc;
}
/* ▼▼▼ ここから追加 ▼▼▼ */
/* ベッド1床分 (1行) のグループ */
.bed-row-group {
    height: var(--row-height);
    box-sizing: border-box;
    border-bottom: 1px solid #ccc;
}
/* ▲▲▲ ここまで追加 ▲▲▲ */

/* ★タイムラインの1行 (5分グリッドの親) */
.timeline-row {
    height: var(--row-height);
    position: relative; /* ★タスクブロックを絶対配置するための基準点 */
    border-bottom: 1px solid #eee; /* 行間の薄い線 */
    box-sizing: border-box;
}
/* ★背景グリッドのコンテナ */
.grid-container {
    position: absolute;
    width: 100%;
    height: 100%;
    display: flex;
}
/* 3行のうち最後の行だけ線を太くする */
.timeline-row:last-child {
    border-bottom: 1px solid #ccc;
}
/* ドラッグ中の行のスタイル */
.timeline-row:hover {
    background-color: #f0f8ff;
}



/* ★5分ごとのセル (JSで生成) */
.grid-cell {
    width: var(--col-width-5min); /* 5分幅 */
    height: 100%;
    border-right: 1px dotted #ddd; /* 5分ごとの点線 */
    box-sizing: border-box;
}

/* 10分ごとの線 (JSでクラス付与) */
.grid-cell.ten-min-line {
    border-right: 1px solid #ccc;
}
/* 30分ごとの線 (JSでクラス付与) */
.grid-cell.half-hour-line {
    border-right: 1px solid #aaa;
}
/* 1時間ごとの線 (JSでクラス付与) */
.grid-cell.hour-line {
    border-right: 1px solid #999;
}

/* ★タブ切り替えボタン */
.controls-container {
    display: flex;
    justify-content: flex-start; /* 左詰め */
    align-items: center;
    gap: 20px;
    margin-bottom: 0;
}
.control-group {
    display: flex;
    align-items: center;
    gap: 20px;
}

.nurse-count-settings {
    display: flex;
    gap: 15px;
    font-size: 14px;
}
.nurse-count-settings input {
    width: 40px;
}
.mode-tabs {
    margin-bottom: 0;
}
.tab-button {
    padding: 5px 15px;
    border: 1px solid #ccc;
    background-color: #f7f7f7;
    cursor: pointer;
}
/* アクティブな（選択中）タブのスタイル */
.tab-button.active {
    background-color: #e0e0ff;
    border-bottom: 1px solid #e0e0ff;
}

/* ▼▼▼ ゴミ箱のスタイル ▼▼▼ */
.trash-can-area {
    width: 40px;
    height: 30px;
    border: 2px dashed #ccc;
    border-radius: 5px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 18px;
    color: #aaa;
    transition: all 0.2s;
}

/* ゴミ箱の上にタスクがドラッグされた時のスタイル */
.trash-can-area.drag-over {
    transform: scale(1.1);
    background-color: #ffcccc;
    border-color: #ff0000;
    color: #ff0000;
}

/* ▼▼▼ ここからケアリストのスタイルを追加 ▼▼▼ */
/* ▼▼▼ ケアリストのスタイルを調整 ▼▼▼ */
.care-list-container {
    width: 300px;
    flex-shrink: 0;
    background-color: #f9f9f9;
    border: 1px solid #ccc;
    padding: 10px;
    box-sizing: border-box;
}
/* ▲▲▲ ケアリストのスタイルを調整 ▲▲▲ */

.care-list-container h3 {
    margin-top: 0;
    text-align: center;
    font-size: 18px;
}

.care-list-tabs {
    display: flex;
    margin-bottom: 10px;
}

.care-tab {
    flex: 1;
    padding: 8px;
    text-align: center;
    border: 1px solid #ccc;
    background-color: #fff;
    cursor: pointer;
    font-size: 12px;
}

.care-tab.active {
    font-weight: bold;
    border-bottom: 1px solid transparent;
}

/* タブの色分け */
.care-tab[data-category="care"].active { border-color: var(--color-care); background-color: var(--color-care); }
.care-tab[data-category="work"].active { border-color: var(--color-work); background-color: var(--color-work); }
.care-tab[data-category="treatment"].active { border-color: var(--color-treatment); background-color: var(--color-treatment); }
.care-tab[data-category="other"].active { border-color: var(--color-other); background-color: var(--color-other); }
.care-tab[data-category="break"].active { border-color: var(--color-break); background-color: var(--color-break); }

.care-list-body {
    height: calc(100vh - 150px); /* 高さをビューポートに合わせる（調整可） */
    overflow-y: auto;
    border: 1px solid #eee;
}

.care-item {
    display: flex;
    align-items: center;
    padding: 8px;
    border-bottom: 1px solid #eee;
    font-size: 14px;
    cursor: grab; /* ★ドラッグできることを示すカーソル */
}

.care-item-name {
    flex-grow: 1;
}

.care-item-staff,
.care-item-time {
    width: 60px;
    text-align: center;
    flex-shrink: 0;
}

/* リスト項目の色分け */
.care-item[data-category="care"] { background-color: var(--color-care); }
.care-item[data-category="work"] { background-color: var(--color-work); }
.care-item[data-category="treatment"] { background-color: var(--color-treatment); }
.care-item[data-category="other"] { background-color: var(--color-other); }
.care-item[data-category="break"] { background-color: var(--color-break); }
/* ▲▲▲ ここまでケアリストのスタイルを追加 ▲▲▲ */

/* ▼▼▼ ここから病棟関連のスタイルを追加 ▼▼▼ */
.header-container {
    text-align: center;
    margin-bottom: 0;
}

.ward-display-area {
    margin-bottom: 0;
}
.ward-row {
    display: flex;
    align-items: center;
    margin-bottom: 5px;
    padding: 5px;
    border-radius: 5px;
    transition: background-color 0.3s;
}
.ward-row.active {
    background-color: #e0e0ff;
}
.ward-tab {
    width: 100px;
    flex-shrink: 0;
}
.bed-display-container {
    display: flex;
    gap: 4px;
    padding-left: 10px;
    flex-wrap: nowrap;
    overflow-x: auto;
}
.bed-box {
    width: 30px;
    height: 30px;
    display: flex;
    justify-content: center;
    align-items: center;
    border: 1px solid #ccc;
    background-color: #fff;
    font-size: 12px;
    font-weight: bold;
    flex-shrink: 0;
}
.bed-box:hover { background-color: #f0f0f0; cursor: pointer; }

/* ▲▲▲ ここまで病棟関連のスタイルを追加 ▲▲▲ */

/* ▼▼▼ モーダルウィンドウのスタイル ▼▼▼ */
.modal-hidden {
    display: none !important; /* 表示を確実に消す */
}

#modal-overlay,
#patient-modal-overlay { /* ★患者情報モーダルにも適用 */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000; /* 他の要素より手前に表示 */
}

#task-modal {
    background-color: #fff;
    padding: 20px 30px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    width: 400px;
}

#task-modal h2 {
    margin-top: 0;
    text-align: center;
    font-size: 20px;
    margin-bottom: 25px;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    font-size: 14px;
}

.modal-task-name-display {
    font-size: 16px;
    margin: 0;
    padding: 5px;
    background-color: #f4f4f4;
    border-radius: 4px;
}

.modal-checkbox-list {
    max-height: 150px;
    overflow-y: auto;
    border: 1px solid #ccc;
    padding: 10px;
    border-radius: 4px;
}

/* ★モーダル内のチェックボックスとラベルを横並びにする */
.modal-checkbox-item {
    display: flex;
    align-items: center;
    margin-bottom: 5px;
}

.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 30px;
}

/* 削除ボタンを左側に配置するための設定 */
.danger-btn {
    margin-right: auto; 
}

/* ▼▼▼ 削除ボタンのスタイル ▼▼▼ */
.danger-btn {
    background-color: #ff4d4d;
    color: white;
}
.danger-btn:hover {
    background-color: #cc0000;
}
/* ▲▲▲ モーダルウィンドウのスタイル ▲▲▲ */

/* ▼▼▼ タイムライン上のタスクブロックのスタイル ▼▼▼ */
.task-block {
    position: absolute;
    height: calc(var(--row-height) - 2px); /* 行の高さより少し小さく */
    top: 1px; /* 行の中央に配置 */
    background-color: #aee1e1; /* デフォルト色 */
    border: 1px solid #888;
    border-radius: 4px;
    box-sizing: border-box;
    padding: 0 5px;
    font-size: 12px;
    color: #333;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: flex;
    align-items: center;
    z-index: 10; /* グリッド線より手前に */
    cursor: pointer; /* クリックできることを示す */
}

.task-block:hover {
    filter: brightness(95%);
    border-width: 2px;
}

/* タスクカテゴリごとの色 */
.task-block[data-category="care"] { background-color: var(--color-care); border-color: #7bafaf; }
.task-block[data-category="work"] { background-color: var(--color-work); border-color: #c4a86a; }
.task-block[data-category="treatment"] { background-color: var(--color-treatment); border-color: #cc8f8f; }
.task-block[data-category="other"] { background-color: var(--color-other); border-color: #ababab; }
.task-block[data-category="break"] { background-color: var(--color-break); border-color: #98b898; }

/* ▲▲▲ タイムライン上のタスクブロックのスタイル ▲▲▲ */

/* ▼▼▼ 患者情報モーダルのスタイル ▼▼▼ */
#patient-modal {
    background-color: #fff;
    padding: 20px 30px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    width: 500px;
}
#patient-modal h2 {
    margin-top: 0;
    text-align: center;
    font-size: 20px;
    margin-bottom: 25px;
}
.form-row {
    display: flex;
    gap: 15px;
    align-items: flex-end;
}
.form-row .form-group {
    flex-grow: 1;
}
.checkbox-group {
    display: flex;
    align-items: center;
    gap: 5px;
    white-space: nowrap;
}
.checkbox-group label {
    margin-bottom: 0;
}
.device-checks {
    justify-content: space-around;
    padding: 10px 0;
}
.plan-group {
    justify-content: space-between;
}
.plan-time-hidden {
    visibility: hidden;
}
#patient-modal textarea {
    width: 100%;
    box-sizing: border-box;
    font-family: sans-serif;
    font-size: 14px;
    padding: 5px;
}
#patient-modal select, #patient-modal input[type="text"], #patient-modal input[type="time"] {
    width: 100%;
    padding: 5px;
    box-sizing: border-box;
}
/* 患者概要の自由記述欄 */
#patient-summary-text {
    display: none; /* 初期状態は非表示 */
    margin-top: 5px;
}
/* ▲▲▲ 患者情報モーダルのスタイル ▲▲▲ */